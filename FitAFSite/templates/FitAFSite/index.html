{% extends "base.html" %}
{% load static %}

{% block title %}
  Meals
{% endblock title %}

{% block extra_styles %}
<style>html{visibility: hidden;opacity:0;}</style>
<link rel="stylesheet" href="{% static 'FitAFSite/css/index.css' %}">
{% endblock extra_styles %}

{% block content %}
<div id='app' style='width:100%;'>

  <!-- date picker -->
  <div class='container'>
    Date: <input type="date" name="bday" v-model='date' v-on:change="getMeal">
  </div>
      
  <!-- meal logs -->
  <div class="meal-log">
    <div class="row">
      <div class="col-md-8">
        <div>

          <ul>
            <!-- breakfast -->
            <a 
            v-on:click="set_add_meal_modal_data('breakfast')" 
            class='modal-trigger'
            href="#add_meal_modal"
            >
              <li class="meal-lable-log">
                <span>Breakfast</span>
                <i class='fas fa-plus'></i>
            </li>
            </a>
            <li
              v-for="mealz, i in breakfast_meals"
              v-bind:key="i"
              class='meal-item-log'
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('breakfast', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <span class='control-buttons left-brdr'>
                <i 
                v-on:click='parse_removal_index("breakfast", i)'
                class='fas fa-times'
                ></i>
              </span>    
            </li>

            <!-- snack1 -->
            <a 
            v-on:click="set_add_meal_modal_data('snack1')" 
            class='modal-trigger'
            href="#add_meal_modal"
            >
              <li class="meal-lable-log">
                <span>Snack</span>
                <i class='fas fa-plus'></i>
              </li>
            </a>
            <li
              v-for="mealz, i in snack1_meals"
              v-bind:key="i"
              class='meal-item-log'
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('snack1', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <span class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("snack1", i)'
                class='fas fa-times'
                ></i>
              </span>    
            </li>
          
            <!-- lunch -->
            <a 
            v-on:click="set_add_meal_modal_data('lunch')" 
            class='modal-trigger'
            href="#add_meal_modal"
            >
              <li class="meal-lable-log">
                <span>Lunch</span>
                <i class='fas fa-plus'></i>
              </li>
            </a>
            <li
              v-for="mealz, i in lunch_meals"
              v-bind:key="i"
              class='meal-item-log'
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('lunch', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <span class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("lunch", i)'
                class='fas fa-times'
                ></i>
              </span>    
            </li>
          
            <!-- snack2 -->
            <a 
            v-on:click="set_add_meal_modal_data('snack2')" 
            class='modal-trigger'
            href="#add_meal_modal"
            >
              <li class="meal-lable-log">
                <span>Snack</span>
                <i class='fas fa-plus'></i>
              </li>
            </a>
            <li
              v-for="mealz, i in snack2_meals"
              v-bind:key="i"
              class='meal-item-log'
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('snack2', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <span class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("snack2", i)'
                class='fas fa-times'
                ></i>
              </span>    
            </li>
          
            <!-- dinner -->
            <a 
            v-on:click="set_add_meal_modal_data('dinner')" 
            class='modal-trigger'
            href="#add_meal_modal"
            >
              <li class="meal-lable-log">
                <span>Dinner</span>
                <i class='fas fa-plus'></i>
              </li>
            </a>
            <li
              v-for="mealz, i in dinner_meals"
              v-bind:key="i"
              class='meal-item-log'
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('dinner', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <span class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("dinner", i)'
                class='fas fa-times'
                ></i>
              </span>    
            </li>
          
            <!-- night_snack -->
            <a 
            v-on:click="set_add_meal_modal_data('night_snack')" 
            class='modal-trigger'
            href="#add_meal_modal"
            >
              <li class="meal-lable-log late-night-snack">
                <span>Late Night Snack</span>
                <i class='modal-trigger fas fa-plus'></i>
              </li>
            </a>
            <li
              v-for="mealz, i in night_snack_meals"
              v-bind:key="i"
              class='meal-item-log'
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('night_snack', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <span class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("night_snack", i)'
                class='fas fa-times'
                ></i>
              </span>    
            </li>
          </ul>

          <ul>
            <li>
              <span> Total Calories </span>
              <span class="left-brdr">${ cal_tot } / ${owner.daily_calorie} daily goal</span>  
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Add Meal Modal -->
  <div id="add_meal_modal" class="modal">
    <div class="modal-content">
      <h3>Search:</h3>
      <input 
        type="text"
        id="in_meal"
        v-model='meal_search'
        placeholder="Search food by name eg. scrambled eggs"
      >
    </div>
    <div class="modal-footer">
      <a 
        v-on:click='food_search'  
        href="#add_meal_search_modal" 
        class="modal-close waves-effect waves-green btn-flat modal-trigger"
      >
      Done
      </a>
    </div>  
  </div> <!-- end Add Meal Modal -->

  <!-- add_meal search results -->
  <div id="add_meal_search_modal" class="modal">
    <div class="modal-content">
      <ul>
        <li
          v-for="meal, i in search_results"
          v-bind:key="i"
          class='meal-search-results-modal row'
        >
          <a @click='create_add_food(meal)' class='modal-close results-img'>
            <div class='results-img-cont col'>
              <img class='results-img' v-bind:src=meal.food.image alt="">
            </div>
            <span class="left-brdr col"> ${ meal.food.label } </span>
            <span class="left-brdr col">Calories: ${ meal.food.nutrients.ENERC_KCAL }</span>   
          </a>
        </li>
      </ul>
    </div>
    <div class="modal-footer">
      <a v-on:click="clear_search" class="modal-close waves-effect waves-green btn-flat"> Done </a>
    </div>  
  </div> <!-- end add_meal search results -->

  <!-- Servings Modal -->
  <div id="servings_modal" class="modal">
  <div class="modal-content">
      <input 
      type="number"
      id="servings"
      v-model='modal_servings'
    >
  </div>
  <div class="modal-footer">
    <a 
      v-on:click='set_clear_serv_modal_data'  
      href="#!" 
      class="modal-close waves-effect waves-green btn-flat"
    >
    Done
    </a>
  </div>  
  </div>

  <!-- Search Modal -->
  <div id="search_modal" class="modal">
      <div class="modal-content">
        <div class="search-box row">
          <div class="search-ingrs">
            <div class="col s12 m5 l5 thin-brdr">
              <div class="input-field col s12">
                <input v-model="ingr_one" type="text" id="ingr_one">
                <label for="ingr_one">Ingredient One</label>
              </div>
              <div class="input-field col s12">
                <input v-model="ingr_two" type="text" id="ingr_two">
                <label for="ingr_two">Ingredient Two</label>
              </div>
              <div class="input-field col s12">
                <input v-model="ingr_three" type="text" id="ingr_three">
                <label for="ingr_three">Ingredient Three</label>
              </div>
              <div class="input-field col s12">
                <input v-model="ingr_four" type="text" id="ingr_four">
                <label for="ingr_four">Ingredient Four</label>
              </div>
            </div>
          </div>
          <div class="col s12 m5 l5 thin-brdr">
            <div class="search-cooktime input-field col s12">
              <input v-model="recipe.cooktime" type="number" id="cooktime">
              <label for="cooktime">Cook Time:</label>
            </div>
            <div class="search-cal input-field col s12">
              <label for="search-cals">Calories:</label>
              <input v-model="recipe.calories" type="number" id="search-cals">
            </div>
          </div>
          <div id='suggestionBox' class="col s12 m7 l7">    
            <a v-bind:href="recipe.url">
              <div class=''>
                <img v-bind:src='recipe.image' alt=""> 
              </div>
            </a> 
          </div>
          <div class="col s12 m6 l6 thin-brdr" id='sugg-info-card'>
            <p> ${recipe.title} </p>
            <p>Calories: ${ recipe.tot_calories } </p>
            <p>Servings made: ${ recipe.tot_serv } </p>
            <p>Fat: ${ recipe.fat } </p>
            <p>Carb: ${ recipe.carb } </p>
            <p>Protein: ${ recipe.pro } </p>

          </div>
        </div>
      </div>
      <div class="modal-footer">
      <a v-on:click='suggestion' class="waves-effect waves-green btn-flat">Search</a>
      <a href="#recipe_choose_mealtime_modal" class="modal-close waves-effect waves-green btn-flat modal-trigger">Add</a>
    </div> 
  </div> <!-- end Serch Modal -->

  <!-- recipe choose modal -->
  <div id="recipe_choose_mealtime_modal" class='modal'>  
    <div class='modal-content'>
      <button v-on:click="search_modal_handler('breakfast')" class='modal-close'>Breakfast</button>
      <button v-on:click="search_modal_handler('snack1')" class='modal-close'>Snack 1</button>
      <button v-on:click="search_modal_handler('lunch')" class='modal-close'>Lunch</button>
      <button v-on:click="search_modal_handler('snack2')" class='modal-close'>Snack 2</button>
      <button v-on:click="search_modal_handler('dinner')" class='modal-close'>Dinner</button>
      <button v-on:click="search_modal_handler('night_snack')" class='modal-close'>Late Night Snack</button>
    </div>
    <div class='modal-footer'>
      
    </div>
  </div><!-- end recipe choose modal -->
  
  <!-- User Modal -->
  <div id="user_modal" class="modal">
    <div class="modal-content">
        <h1> ${ owner.username } </h1>
        <div class='Biometrics col' >
          <div class="input-field col s6">
            <input 
            type="number"
            id="weight"
            v-model = 'owner.weight'
            >
            <label for="weight">weight</label>
          </div>
          <div class="input-field col s6">
            <input 
            type="number"
            id="height"
            v-model='owner.height'
            >
            <label for="height">height</label>
          </div>
          <div class="input-field col s6">
            <input 
            type="number"
            id="age"
            v-model = 'owner.age'
            >
            <label for="age">age</label>
          </div>
          
          <div style='display: flex; justify-content: space-around'>
            <a class='dropdown-trigger btn' href='#' data-target='dropdown1'>activity level</a>
            <a class='dropdown-trigger btn' href='#' data-target='dropdown2'>Gender</a>
          </div>
  
          <!-- Dropdown Structure -->
          <ul id='dropdown1' class='dropdown-content'>
            <li><a v-on:click="owner.activity = 1.2" href="#!">sedentary</a></li>
            <li><a v-on:click="owner.activity = 1.375" href="#!">lightly active</a></li>
            <li><a v-on:click="owner.activity = 1.55" href="#!">moderately active</a></li>
            <li><a v-on:click="owner.activity = 1.725" href="#!">very active</a></li>
            <li><a v-on:click="owner.activity = 1.9" href="#!">extra active</a></li>
          </ul>
  
  
          <!-- Dropdown Structure -->
          <ul id='dropdown2' class='dropdown-content'>
            <li><a v-on:click="owner.gender = 0" href="#!">Female</a></li>
            <li><a v-on:click="owner.gender = 1"  href="#!">Male</a></li>
          </ul>
  
        </div>
        <div>
          <p></p>
        </div>

        <!-- <label for="goals"> <h2>Goals</h2> </label>
        <div id="goals" class="col" style="border: 10px solid green">
          <label for="carb">carbohydrates</label>
          <input 
            type="number"  
            id="carb"
            v-model="owner.carb_goal"
          >
          <label for="protein">protein</label>
          <input 
            type="number"  
            id="protein"
            v-model="owner.protein_goal"
          >
          <label for="fat">fat</label>
          <input 
            type="number"  
            id="fat"
            v-model="owner.fat_goal"
          >
        </div> -->
        <h4>Calories</h4>
        <div class="calories">
          <div class="input-field col s6">
            <input 
            type="number"
            id="calories"
            v-model = "owner.daily_calorie"
            >
            <label for="calories">leave blank to compute</label>
          </div>
        </div>
    </div>
    <div class="modal-footer">
        <a v-on:click='modOwner'  href="#!" class="modal-close waves-effect waves-green btn-flat">Agree</a>
    </div>
  </div> <!-- end User Modal -->
  
</div> <!-- end app -->
{% endblock content %}

{% block extra_scripts %}
<script src="{% static 'FitAFSite/js/app.js' %}"></script>
{% endblock extra_scripts %}