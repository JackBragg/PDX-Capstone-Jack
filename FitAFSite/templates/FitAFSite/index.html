{% extends "base.html" %}
{% load static %}

{% block title %}
  Meals
{% endblock title %}

{% block extra_styles %}
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.12/css/all.css" integrity="sha384-G0fIWCsCzJIMAVNQPfjH08cyYaUtMwjJwqiRKxxE/rx96Uroj1BtIQ6MLJuheaO9" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
<style>html{visibility: hidden;opacity:0;}</style>
<link rel="stylesheet" href="{% static 'FitAFSite/css/index.css' %}">
{% endblock extra_styles %}

{% block content %}
<div id='app' style='width:100%;'>

  <!-- date picker -->
  <div class='container'>
    Date: <input type="date" name="bday" v-model='date' v-on:change="getMeal">
  </div>
      
  <!-- meal logs -->
  <div class="meal-log">
    <div class="row">
      <div class="col-md-8">
        <div>

          <ul>
            <!-- breakfast -->
            <li class="meal-lable-log">
              <span>Breakfast</span>
              <i
                v-on:click="set_add_meal_modal_data('breakfast')" 
                class='modal-trigger fas fa-plus'
                href="#add_meal_modal"
                ></i>
            </li>
            <li
              v-for="mealz, i in breakfast_meals"
              v-bind:key="i"
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('breakfast', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <div class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("breakfast", i)'
                class='fas fa-times'
                ></i>
              </div>    
            </li>

            <!-- snack1 -->
            <li class="meal-lable-log">
              <span>Snack</span>
              <i
                v-on:click="set_add_meal_modal_data('snack1')" 
                class='modal-trigger fas fa-plus'
                href="#add_meal_modal"
                ></i>
            </li>
            <li
              v-for="mealz, i in snack1_meals"
              v-bind:key="i"
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('snack1', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <div class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("snack1", i)'
                class='fas fa-times'
                ></i>
              </div>    
            </li>
          
            <!-- lunch -->
            <li class="meal-lable-log">
              <span>Lunch</span>
              <i
                v-on:click="set_add_meal_modal_data('lunch')" 
                class='modal-trigger fas fa-plus'
                href="#add_meal_modal"
                ></i>
            </li>
            <li
              v-for="mealz, i in lunch_meals"
              v-bind:key="i"
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('lunch', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <div class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("lunch", i)'
                class='fas fa-times'
                ></i>
              </div>    
            </li>
          
            <!-- snack2 -->
            <li class="meal-lable-log">
              <span>Snack</span>
              <i
                v-on:click="set_add_meal_modal_data('snack2')" 
                class='modal-trigger fas fa-plus'
                href="#add_meal_modal"
                ></i>
            </li>
            <li
              v-for="mealz, i in snack2_meals"
              v-bind:key="i"
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('snack2', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <div class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("snack2", i)'
                class='fas fa-times'
                ></i>
              </div>    
            </li>
          
            <!-- dinner -->
            <li class="meal-lable-log">
              <span>Dinner</span>
              <i
                v-on:click="set_add_meal_modal_data('dinner')" 
                class='modal-trigger fas fa-plus'
                href="#add_meal_modal"
                ></i>
            </li>
            <li
              v-for="mealz, i in dinner_meals"
              v-bind:key="i"
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('dinner', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <div class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("dinner", i)'
                class='fas fa-times'
                ></i>
              </div>    
            </li>
          
            <!-- night_snack -->
            <li class="meal-lable-log late-night-snack">
              <span>Late Night Snack</span>
              <i
                v-on:click="set_add_meal_modal_data('night_snack')" 
                class='modal-trigger fas fa-plus'
                href="#add_meal_modal"
                ></i>
            </li>
            <li
              v-for="mealz, i in night_snack_meals"
              v-bind:key="i"
            >
              <span> ${ mealz.title } </span>
              <span class="left-brdr">Calories: ${ mealz.eaten_cals() }</span>
              <span class="left-brdr">
                <a v-on:click="serv_modal_func('night_snack', i)" class="modal-trigger" href="#servings_modal">
                  Servings: ${ mealz.servings }
                </a>
              </span>
              <div class='control-buttons left-brdr'>
                <i v-on:click='parse_removal_index("night_snack", i)'
                class='fas fa-times'
                ></i>
              </div>    
            </li>
          </ul>

          <ul>
            <li>
              <span> Total Calories </span>
              <span class="left-brdr">${ cal_tot } / ${owner.daily_calorie} daily goal</span>  
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Add Meal Modal -->
  <div id="add_meal_modal" class="modal">
    <div class="modal-content">
      <input 
        type="text"
        id="in_meal"
        v-model='meal_search'
      >
    </div>
    <div class="modal-footer">
      <a 
        v-on:click='food_search'  
        href="#add_meal_search_modal" 
        class="modal-close waves-effect waves-green btn-flat modal-trigger"
      >
      Done
      </a>
    </div>  
  </div> <!-- end Add Meal Modal -->

  <!-- add_meal search results -->
  <div id="add_meal_search_modal" class="modal">
    <div class="modal-content">
      <ul>
        <li
          v-for="meal, i in search_results"
          v-bind:key="i"
        >
          <a @click='create_add_food(meal)' class='modal-close'>
            <img v-bind:src=meal.food.image alt="XO">
          </a>
          <span> ${ meal.food.label } </span>
          <span class="left-brdr">Calories: ${ meal.food.nutrients.ENERC_KCAL }</span>
          <div class='control-buttons left-brdr'>
            <i v-on:click='create_add_food(meal)'
            class='fas fa-plus modal-close'
            ></i>
          </div>    
        </li>
      </ul>
    </div>
    <div class="modal-footer">
      <a 
        v-on:click='modal_add_meal'  
        href="#!" 
        class="modal-close waves-effect waves-green btn-flat"
      >
      Done
      </a>
    </div>  
  </div> <!-- end add_meal search results -->

  <!-- Servings Modal -->
  <div id="servings_modal" class="modal">
  <div class="modal-content">
      <input 
      type="number"
      id="servings"
      v-model='modal_servings'
    >
  </div>
  <div class="modal-footer">
    <a 
      v-on:click='set_clear_serv_modal_data'  
      href="#!" 
      class="modal-close waves-effect waves-green btn-flat"
    >
    Done
    </a>
  </div>  
  </div>

  
  <!-- Search Modal -->
  <div id="search_modal" class="modal" style="height: 400px; width: 1000px;">
      <div class="modal-content">
        <div class="search-box">
          <div class="search-ingrs">
            <label for="ingr_one">Ingredient One</label>
            <input v-model="ingr_one" type="text" id="ingr_one">
            <label for="ingr_two">Ingredient Two</label>
            <input v-model="ingr_two" type="text" id="ingr_two">
            <label for="ingr_three">Ingredient Three</label>
            <input v-model="ingr_three" type="text" id="ingr_three">
            <label for="ingr_four">Ingredient Four</label>
            <input v-model="ingr_four" type="text" id="ingr_four">
          </div>
          <div class="search-cooktime">
            <label for="cooktime">Cook Time:</label>
            <input v-model="recipe.cooktime" type="number" id="cooktime">
          </div>
          <div class="search-cal">
            <label for="search-cals">Calories:</label>
            <input v-model="recipe.cooktime" type="number" id="search-cals">
          </div>
          <div id='suggestionBox' style="background-size: contain; max-height: 100px; max-width: 100px;">    
            <a v-bind:href="recipe.url">
              <img v-bind:src='recipe.image' alt=""> 
            </a> 
          </div>
          <div id='sugg-info-card'>
            <p> ${recipe.title} </p>
            <p>Calories: ${ recipe.tot_calories } </p>
            <p>Servings made: ${ recipe.tot_serv } </p>
            <p>Fat: ${ recipe.fat } </p>
            <p>Carb: ${ recipe.carb } </p>
            <p>Protein: ${ recipe.pro } </p>

          </div>
        </div>
      </div>
      <div class="modal-footer">
      <a v-on:click='suggestion' class="waves-effect waves-green btn-flat">Search</a>
      <a href="#recipe_choose_mealtime_modal" class="modal-close waves-effect waves-green btn-flat modal-trigger">Add</a>
    </div> 
  </div> <!-- end Serch Modal -->

  <!-- recipe choose modal -->
  <div id="recipe_choose_mealtime_modal" class='modal'>  
    <div class='modal-content'>
      <button v-on:click="search_modal_handler('breakfast')" class='modal-close'>Breakfast</button>
      <button v-on:click="search_modal_handler('snack1')" class='modal-close'>Snack 1</button>
      <button v-on:click="search_modal_handler('lunch')" class='modal-close'>Lunch</button>
      <button v-on:click="search_modal_handler('snack2')" class='modal-close'>Snack 2</button>
      <button v-on:click="search_modal_handler('dinner')" class='modal-close'>Dinner</button>
      <button v-on:click="search_modal_handler('night_snack')" class='modal-close'>Late Night Snack</button>
    </div>
    <div class='modal-footer'>
      
    </div>
  </div><!-- end recipe choose modal -->
  
  <!-- User Modal -->
  <div id="user_modal" class="modal">
    <div class="modal-content">
        <h1> ${ owner.username } </h1>
        <div class='Biometrics col' style="border: 10px solid blue">
          <label for="weight">weight</label>
          <input 
            type="number"
            id="weight"
            v-model = 'owner.weight'
          >
          <label for="height">height</label>
          <input 
            type="number"
            id="height"
            v-model='owner.height'
          >
          <label for="age">age</label>
          <input 
            type="number"
            id="age"
            v-model = 'owner.age'
          >
  
          <a class='dropdown-trigger btn' href='#' data-target='dropdown1'>activity level</a>
  
          <!-- Dropdown Structure -->
          <ul id='dropdown1' class='dropdown-content'>
            <li><a v-on:click="owner.activity = 1.2" href="#!">sedentary</a></li>
            <li><a v-on:click="owner.activity = 1.375" href="#!">lightly active</a></li>
            <li><a v-on:click="owner.activity = 1.55" href="#!">moderately active</a></li>
            <li><a v-on:click="owner.activity = 1.725" href="#!">very active</a></li>
            <li><a v-on:click="owner.activity = 1.9" href="#!">extra active</a></li>
          </ul>
  
          <a class='dropdown-trigger btn' href='#' data-target='dropdown2'>Gender</a>
  
          <!-- Dropdown Structure -->
          <ul id='dropdown2' class='dropdown-content'>
            <li><a v-on:click="owner.gender = 0" href="#!">Female</a></li>
            <li><a v-on:click="owner.gender = 1"  href="#!">Male</a></li>
          </ul>
  
        </div>
        <label for="goals">goals</label>
        <div id="goals" class="col" style="border: 10px solid green">
          <label for="carb">carbohydrates</label>
          <input 
            type="number"  
            id="carb"
            v-model="owner.carb_goal"
          >
          <label for="protein">protein</label>
          <input 
            type="number"  
            id="protein"
            v-model="owner.protein_goal"
          >
          <label for="fat">fat</label>
          <input 
            type="number"  
            id="fat"
            v-model="owner.fat_goal"
          >
        </div>
        <label for="calories">calories</label>
        <div class="calories">
          <input 
            type="number"
            id="calories"
            v-model = "owner.daily_calorie"
          >
        </div>
    </div>
    <div class="modal-footer">
        <a v-on:click='modOwner'  href="#!" class="modal-close waves-effect waves-green btn-flat">Agree</a>
    </div>
  </div> <!-- end User Modal -->
  
</div> <!-- end app -->
{% endblock content %}

{% block extra_scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script src="{% static 'FitAFSite/js/index.js' %}"></script>
<script src="{% static 'FitAFSite/js/app.js' %}"></script>
{% endblock extra_scripts %}